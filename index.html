<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>AQ tillg√§ngligt underst√∂d</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      padding: 40px;
    }

    h1 {
      margin-bottom: 40px;
    }

    h2 {
      margin-top: 40px;
      margin-bottom: 15px;
      border-bottom: 2px solid #ccc;
      padding-bottom: 5px;
    }

    .option {
      padding: 18px 22px;
      margin-bottom: 12px;
      border-radius: 8px;
      font-size: 18px;
      cursor: pointer;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .available {
      background: #2ecc71;
    }

    .cooldown {
      background: #e74c3c;
      cursor: not-allowed;
    }

    .time {
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>AQ tillg√§ngligt underst√∂d</h1>

<div id="options"></div>

<script>
  // üî• ERS√ÑTT MED DIN FIREBASE-CONFIG
  const firebaseConfig = {
    apiKey: "AIzaSyCYnaILVldS539dZlkt6Fc0WBmRGSu_TFk",
    authDomain: "aq-underst.firebaseapp.com",
    databaseURL: "https://aq-underst-default-rtdb.firebaseio.com",
    projectId: "aq-underst",
    storageBucket: "aq-underst.firebasestorage.app",
    messagingSenderId: "416888465206",
    appId: "1:416888465206:web:20b87852b8093ecdd2b597"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // üß± STRUKTUR + COOLDOWNS (sekunder)
  const SECTIONS = [
    {
      title: "tillg√§ngliga fr√•n b√∂rjan",
      options: [
        { id: "stridspar", name: "ett eget stridspar", cooldown: 15 * 60 },
        { id: "grk_1", name: "8,5cm GRK salva", cooldown: 30 * 60 }
      ]
    },
    {
      title: "capture 1 military base",
      options: [
        { id: "grk_2", name: "2 salvor 8,5cm GRK", cooldown: 30 * 60 },
        { id: "soldater", name: "en grupp soldater", cooldown: 30 * 60 }
      ]
    },
    {
      title: "capture 3 military bases",
      options: [
        { id: "artilleri", name: "155mm artilleri salva", cooldown: 45 * 60 },
        { id: "stridsfordon", name: "underst√∂d av stridsfordon", cooldown: 90 * 60 }
      ]
    },
    {
      title: "capture 1 airbase",
      options: [
        { id: "heli", name: "helikopter strafe run", cooldown: 45 * 60 },
        { id: "lgb", name: "laserguided bomb", cooldown: 90 * 60 }
      ]
    },
    {
      title: "capture 1 resource",
      options: [
        { id: "ammo", name: "ammunition drop", cooldown: 30 * 60 }
      ]
    }
  ];

  const container = document.getElementById("options");

  function formatTime(seconds) {
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return `${m}:${s.toString().padStart(2, "0")}`;
  }

  SECTIONS.forEach(section => {
    const h2 = document.createElement("h2");
    h2.textContent = section.title;
    container.appendChild(h2);

    section.options.forEach(opt => {
      const div = document.createElement("div");
      div.className = "option available";
      div.innerHTML = `
        <span>${opt.name}</span>
        <span class="time">Tillg√§nglig</span>
      `;

      const ref = db.ref("cooldowns/" + opt.id);

      div.onclick = () => {
        ref.once("value").then(snapshot => {
          const now = Date.now();
          const end = snapshot.val();
          if (!end || now >= end) {
            ref.set(now + opt.cooldown * 1000);
          }
        });
      };

      ref.on("value", snapshot => {
        const end = snapshot.val();

        function update() {
          const now = Date.now();
          if (!end || now >= end) {
            div.className = "option available";
            div.querySelector(".time").textContent = "Tillg√§nglig";
          } else {
            div.className = "option cooldown";
            const remaining = Math.ceil((end - now) / 1000);
            div.querySelector(".time").textContent = formatTime(remaining);
            setTimeout(update, 1000);
          }
        }
        update();
      });

      container.appendChild(div);
    });
  });
</script>

</body>
</html>
<!-- pages-trigger -->
